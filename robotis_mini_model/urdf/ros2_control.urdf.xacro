<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <xacro:arg name="use_sim" default="true"/>

  <!-- Default joint list. -->
  <xacro:property name="joints" value="
    l_hip_yaw l_hip_roll l_hip_pitch
    l_knee     l_ankle_pitch l_ankle_roll
    r_hip_yaw r_hip_roll r_hip_pitch
    r_knee     r_ankle_pitch r_ankle_roll
    l_shoulder_pitch l_shoulder_roll l_elbow
    r_shoulder_pitch r_shoulder_roll r_elbow
  "/>

  <xacro:macro name="ifaces_for_joint" params="name">
    <joint name="${name}">
      <command_interface name="position"/>
      <state_interface   name="position"/>
      <state_interface   name="velocity"/>
      <state_interface   name="effort"/>
    </joint>
  </xacro:macro>

  <xacro:macro name="robotis_mini_ros2">
    <ros2_control name="robotis_mini" type="system">
      <hardware>
        <xacro:if value="$(arg use_sim)">
          <plugin>robotis_mini/hardware_sim</plugin>
        </xacro:if>
        <xacro:unless value="$(arg use_sim)">
          <plugin>robotis_mini/hardware</plugin>
        </xacro:unless>

        <!-- Params for real hardware. -->
        <param name="port">/dev/ttyUSB0</param>
        <param name="baud">1000000</param>
        <param name="protocol">2.0</param>
      </hardware>

      <!-- Emit interfaces for every joint in ${joints} -->
      <!-- TODO -->
    </ros2_control>
  </xacro:macro>

</robot>